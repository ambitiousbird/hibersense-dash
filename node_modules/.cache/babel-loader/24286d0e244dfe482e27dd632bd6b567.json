{"ast":null,"code":"import * as d3 from \"d3-3\";\nexport const pieTop = function (d, rx, ry, ir) {\n  if (d.endAngle - d.startAngle === 0) return \"M 0 0\";\n  var sx = rx * Math.cos(d.startAngle),\n      sy = ry * Math.sin(d.startAngle),\n      ex = rx * Math.cos(d.endAngle),\n      ey = ry * Math.sin(d.endAngle);\n  var ret = [];\n  ret.push(\"M\", sx, sy, \"A\", rx, ry, \"0\", d.endAngle - d.startAngle > Math.PI ? 1 : 0, \"1\", ex, ey, \"L\", ir * ex, ir * ey);\n  ret.push(\"A\", ir * rx, ir * ry, \"0\", d.endAngle - d.startAngle > Math.PI ? 1 : 0, \"0\", ir * sx, ir * sy, \"z\");\n  return ret.join(\" \");\n};\nexport const pieOuter = (d, rx, ry, h) => {\n  var startAngle = d.startAngle > Math.PI ? Math.PI : d.startAngle;\n  var endAngle = d.endAngle > Math.PI ? Math.PI : d.endAngle;\n  var sx = rx * Math.cos(startAngle),\n      sy = ry * Math.sin(startAngle),\n      ex = rx * Math.cos(endAngle),\n      ey = ry * Math.sin(endAngle);\n  var ret = [];\n  ret.push(\"M\", sx, h + sy, \"A\", rx, ry, \"0 0 1\", ex, h + ey, \"L\", ex, ey, \"A\", rx, ry, \"0 0 0\", sx, sy, \"z\");\n  return ret.join(\" \");\n};\nexport const pieInner = (d, rx, ry, h, ir) => {\n  var startAngle = d.startAngle < Math.PI ? Math.PI : d.startAngle;\n  var endAngle = d.endAngle < Math.PI ? Math.PI : d.endAngle;\n  var sx = ir * rx * Math.cos(startAngle),\n      sy = ir * ry * Math.sin(startAngle),\n      ex = ir * rx * Math.cos(endAngle),\n      ey = ir * ry * Math.sin(endAngle);\n  var ret = [];\n  ret.push(\"M\", sx, sy, \"A\", ir * rx, ir * ry, \"0 0 1\", ex, ey, \"L\", ex, h + ey, \"A\", ir * rx, ir * ry, \"0 0 0\", sx, h + sy, \"z\");\n  return ret.join(\" \");\n};\nexport const getPercent = d => {\n  return d.endAngle - d.startAngle > 0.2 ? d.label + Math.round(1000 * (d.endAngle - d.startAngle) / (Math.PI * 2)) / 10 + '%' : '';\n};\nexport const Donut3D_transition = function (id, data, rx, ry, h, ir) {\n  function arcTweenInner(a) {\n    var i = d3.interpolate(this._current, a);\n    this._current = i(0);\n    return function (t) {\n      return pieInner(i(t), rx + 0.5, ry + 0.5, h, ir);\n    };\n  }\n\n  function arcTweenTop(a) {\n    var i = d3.interpolate(this._current, a);\n    this._current = i(0);\n    return function (t) {\n      return pieTop(i(t), rx, ry, ir);\n    };\n  }\n\n  function arcTweenOuter(a) {\n    var i = d3.interpolate(this._current, a);\n    this._current = i(0);\n    return function (t) {\n      return pieOuter(i(t), rx - .5, ry - .5, h);\n    };\n  }\n\n  function textTweenX(a) {\n    var i = d3.interpolate(this._current, a);\n    this._current = i(0);\n    return function (t) {\n      return 0.6 * rx * Math.cos(0.5 * (i(t).startAngle + i(t).endAngle));\n    };\n  }\n\n  function textTweenY(a) {\n    var i = d3.interpolate(this._current, a);\n    this._current = i(0);\n    return function (t) {\n      return 0.6 * rx * Math.sin(0.5 * (i(t).startAngle + i(t).endAngle));\n    };\n  }\n\n  var _data = d3.layout.pie().sort(null).value(function (d) {\n    return d.value;\n  })(data);\n\n  d3.select(\"#\" + id).selectAll(\".innerSlice\").data(_data).transition().duration(750).attrTween(\"d\", arcTweenInner);\n  d3.select(\"#\" + id).selectAll(\".topSlice\").data(_data).transition().duration(750).attrTween(\"d\", arcTweenTop);\n  d3.select(\"#\" + id).selectAll(\".outerSlice\").data(_data).transition().duration(750).attrTween(\"d\", arcTweenOuter);\n  d3.select(\"#\" + id).selectAll(\".percent\").data(_data).transition().duration(750).attrTween(\"x\", textTweenX).attrTween(\"y\", textTweenY).text(getPercent);\n};\nexport const Donut3D_draw = function (id, data, x\n/*center x*/\n, y\n/*center y*/\n, rx\n/*radius x*/\n, ry\n/*radius y*/\n, h\n/*height*/\n, ir\n/*inner radius*/\n) {\n  var _data = d3.layout.pie().sort(null).value(function (d) {\n    return d.value;\n  })(data);\n\n  var slices = d3.select(\"#\" + id).append(\"g\").attr(\"transform\", \"translate(\" + x + \",\" + y + \")\").attr(\"class\", \"slices\");\n  slices.selectAll(\".innerSlice\").data(_data).enter().append(\"path\").attr(\"class\", \"innerSlice\").style(\"fill\", function (d) {\n    return d3.hsl(d.data.color).darker(0.7);\n  }).attr(\"d\", function (d) {\n    return pieInner(d, rx + 0.5, ry + 0.5, h, ir);\n  }).each(function (d) {\n    this._current = d;\n  });\n  slices.selectAll(\".topSlice\").data(_data).enter().append(\"path\").attr(\"class\", \"topSlice\").style(\"fill\", function (d) {\n    return d.data.color;\n  }).style(\"stroke\", function (d) {\n    return d.data.color;\n  }).attr(\"d\", function (d) {\n    return pieTop(d, rx, ry, ir);\n  }).each(function (d) {\n    this._current = d;\n  });\n  slices.selectAll(\".outerSlice\").data(_data).enter().append(\"path\").attr(\"class\", \"outerSlice\").style(\"fill\", function (d) {\n    return d3.hsl(d.data.color).darker(0.7);\n  }).attr(\"d\", function (d) {\n    return pieOuter(d, rx - .5, ry - .5, h);\n  }).each(function (d) {\n    this._current = d;\n  });\n  slices.selectAll(\".percent\").data(_data).enter().append(\"text\").attr(\"class\", \"percent\").attr(\"x\", function (d) {\n    return 0.6 * rx * Math.cos(0.5 * (d.startAngle + d.endAngle));\n  }).attr(\"y\", function (d) {\n    return 0.6 * ry * Math.sin(0.5 * (d.startAngle + d.endAngle));\n  }).text(getPercent).each(function (d) {\n    this._current = d;\n  });\n};","map":{"version":3,"sources":["/Users/langgao/Documents/HiberSense Dashboard/hibersense-dash/src/components/DonutChart/Donut3D.js"],"names":["d3","pieTop","d","rx","ry","ir","endAngle","startAngle","sx","Math","cos","sy","sin","ex","ey","ret","push","PI","join","pieOuter","h","pieInner","getPercent","label","round","Donut3D_transition","id","data","arcTweenInner","a","i","interpolate","_current","t","arcTweenTop","arcTweenOuter","textTweenX","textTweenY","_data","layout","pie","sort","value","select","selectAll","transition","duration","attrTween","text","Donut3D_draw","x","y","slices","append","attr","enter","style","hsl","color","darker","each"],"mappings":"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","sourcesContent":["import * as d3 from \"d3-3\";\n\t\nexport const pieTop = function(d, rx, ry, ir ){\n\t\tif(d.endAngle - d.startAngle === 0 ) return \"M 0 0\";\n\t\tvar sx = rx*Math.cos(d.startAngle),\n\t\t\tsy = ry*Math.sin(d.startAngle),\n\t\t\tex = rx*Math.cos(d.endAngle),\n\t\t\tey = ry*Math.sin(d.endAngle);\n\t\t\t\n\t\tvar ret =[];\n\t\tret.push(\"M\",sx,sy,\"A\",rx,ry,\"0\",(d.endAngle-d.startAngle > Math.PI? 1: 0),\"1\",ex,ey,\"L\",ir*ex,ir*ey);\n\t\tret.push(\"A\",ir*rx,ir*ry,\"0\",(d.endAngle-d.startAngle > Math.PI? 1: 0), \"0\",ir*sx,ir*sy,\"z\");\n\t\treturn ret.join(\" \");\n}\n\nexport const pieOuter=(d, rx, ry, h )=>{\n\t\tvar startAngle = (d.startAngle > Math.PI ? Math.PI : d.startAngle);\n\t\tvar endAngle = (d.endAngle > Math.PI ? Math.PI : d.endAngle);\n\t\t\n\t\tvar sx = rx*Math.cos(startAngle),\n\t\t\tsy = ry*Math.sin(startAngle),\n\t\t\tex = rx*Math.cos(endAngle),\n\t\t\tey = ry*Math.sin(endAngle);\n\t\t\t\n\t\t\tvar ret =[];\n\t\t\tret.push(\"M\",sx,h+sy,\"A\",rx,ry,\"0 0 1\",ex,h+ey,\"L\",ex,ey,\"A\",rx,ry,\"0 0 0\",sx,sy,\"z\");\n\t\t\treturn ret.join(\" \");\n\t}\n\nexport const pieInner=(d, rx, ry, h, ir )=>{\n\t\tvar startAngle = (d.startAngle < Math.PI ? Math.PI : d.startAngle);\n\t\tvar endAngle = (d.endAngle < Math.PI ? Math.PI : d.endAngle);\n\t\t\n\t\tvar sx = ir*rx*Math.cos(startAngle),\n\t\t\tsy = ir*ry*Math.sin(startAngle),\n\t\t\tex = ir*rx*Math.cos(endAngle),\n\t\t\tey = ir*ry*Math.sin(endAngle);\n\n\t\t\tvar ret =[];\n\t\t\tret.push(\"M\",sx, sy,\"A\",ir*rx,ir*ry,\"0 0 1\",ex,ey, \"L\",ex,h+ey,\"A\",ir*rx, ir*ry,\"0 0 0\",sx,h+sy,\"z\");\n\t\t\treturn ret.join(\" \");\n}\n\nexport const getPercent=(d)=>{\n\t\treturn (d.endAngle-d.startAngle > 0.2 ? \n\t\t\t\td.label+Math.round(1000*(d.endAngle-d.startAngle)/(Math.PI*2))/10+'%' : '');\n}\t\n\t\nexport const Donut3D_transition = function(id, data, rx, ry, h, ir){\n\t\tfunction arcTweenInner(a) {\n\t\t  var i = d3.interpolate(this._current, a);\n\t\t  this._current = i(0);\n\t\t  return function(t) { return pieInner(i(t), rx+0.5, ry+0.5, h, ir);  };\n\t\t}\n\t\tfunction arcTweenTop(a) {\n\t\t  var i = d3.interpolate(this._current, a);\n\t\t  this._current = i(0);\n\t\t  return function(t) { return pieTop(i(t), rx, ry, ir);  };\n\t\t}\n\t\tfunction arcTweenOuter(a) {\n\t\t  var i = d3.interpolate(this._current, a);\n\t\t  this._current = i(0);\n\t\t  return function(t) { return pieOuter(i(t), rx-.5, ry-.5, h);  };\n\t\t}\n\t\tfunction textTweenX(a) {\n\t\t  var i = d3.interpolate(this._current, a);\n\t\t  this._current = i(0);\n\t\t  return function(t) { return 0.6*rx*Math.cos(0.5*(i(t).startAngle+i(t).endAngle));  };\n\t\t}\n\t\tfunction textTweenY(a) {\n\t\t  var i = d3.interpolate(this._current, a);\n\t\t  this._current = i(0);\n\t\t  return function(t) { return 0.6*rx*Math.sin(0.5*(i(t).startAngle+i(t).endAngle));  };\n\t\t}\n\t\t\n\t\tvar _data = d3.layout.pie().sort(null).value(function(d) {return d.value;})(data);\n\t\t\n\t\td3.select(\"#\"+id).selectAll(\".innerSlice\").data(_data)\n\t\t\t.transition().duration(750).attrTween(\"d\", arcTweenInner); \n\t\t\t\n\t\td3.select(\"#\"+id).selectAll(\".topSlice\").data(_data)\n\t\t\t.transition().duration(750).attrTween(\"d\", arcTweenTop); \n\t\t\t\n\t\td3.select(\"#\"+id).selectAll(\".outerSlice\").data(_data)\n\t\t\t.transition().duration(750).attrTween(\"d\", arcTweenOuter); \t\n\t\t\t\n\t\td3.select(\"#\"+id).selectAll(\".percent\").data(_data).transition().duration(750)\n\t\t\t.attrTween(\"x\",textTweenX).attrTween(\"y\",textTweenY).text(getPercent); \t\n\t}\n\t\nexport const Donut3D_draw=function(id, data, x /*center x*/, y/*center y*/, \n\t\t\trx/*radius x*/, ry/*radius y*/, h/*height*/, ir/*inner radius*/){\n\t\n\t\tvar _data = d3.layout.pie().sort(null).value(function(d) {return d.value;})(data);\n\t\t\n\t\tvar slices = d3.select(\"#\"+id).append(\"g\").attr(\"transform\", \"translate(\" + x + \",\" + y + \")\")\n\t\t\t.attr(\"class\", \"slices\");\n\t\t\t\n\t\tslices.selectAll(\".innerSlice\").data(_data).enter().append(\"path\").attr(\"class\", \"innerSlice\")\n\t\t\t.style(\"fill\", function(d) { return d3.hsl(d.data.color).darker(0.7); })\n\t\t\t.attr(\"d\",function(d){ return pieInner(d, rx+0.5,ry+0.5, h, ir);})\n\t\t\t.each(function(d){this._current=d;});\n\t\t\n\t\tslices.selectAll(\".topSlice\").data(_data).enter().append(\"path\").attr(\"class\", \"topSlice\")\n\t\t\t.style(\"fill\", function(d) { return d.data.color; })\n\t\t\t.style(\"stroke\", function(d) { return d.data.color; })\n\t\t\t.attr(\"d\",function(d){ return pieTop(d, rx, ry, ir);})\n\t\t\t.each(function(d){this._current=d;});\n\t\t\n\t\tslices.selectAll(\".outerSlice\").data(_data).enter().append(\"path\").attr(\"class\", \"outerSlice\")\n\t\t\t.style(\"fill\", function(d) { return d3.hsl(d.data.color).darker(0.7); })\n\t\t\t.attr(\"d\",function(d){ return pieOuter(d, rx-.5,ry-.5, h);})\n\t\t\t.each(function(d){this._current=d;});\n\n\t\tslices.selectAll(\".percent\").data(_data).enter().append(\"text\").attr(\"class\", \"percent\")\n\t\t\t.attr(\"x\",function(d){ return 0.6*rx*Math.cos(0.5*(d.startAngle+d.endAngle));})\n\t\t\t.attr(\"y\",function(d){ return 0.6*ry*Math.sin(0.5*(d.startAngle+d.endAngle));})\n\t\t\t.text(getPercent).each(function(d){this._current=d;});\t\t\t\t\n}\n"]},"metadata":{},"sourceType":"module"}